# --------------------------------------------------------
#  Copyright (C) 2004-2018 by EMGU Corporation. All rights reserved.
# --------------------------------------------------------

PROJECT(Emgu.TF.Models)

INSTALL(
  DIRECTORY
  ${CMAKE_CURRENT_SOURCE_DIR}
  DESTINATION .
  COMPONENT emgutf_source
FILES_MATCHING 
PATTERN "*.cs"
PATTERN "*.projitems"
PATTERN "*.shproj"
PATTERN ".svn" EXCLUDE
PATTERN "obj" EXCLUDE
PATTERN "CMakeFiles" EXCLUDE
PATTERN "${PROJECT_NAME}.dir" EXCLUDE
)

FILE(GLOB_RECURSE SRC_EMGU_TF_MODEL RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} "/*.cs")

LIST(APPEND SRC_EMGU_TF_MODEL ${CMAKE_CURRENT_SOURCE_DIR}/../CommonAssemblyInfo.cs)
LIST(APPEND SRC_EMGU_TF_MODEL ${CMAKE_CURRENT_SOURCE_DIR}/Properties/AssemblyInfo.cs)

SET(EMGU_TF_REFERENCE 
  -r:System.Net.Http.dll 
  -r:System.Drawing.dll 
  -r:"${LIBRARY_OUTPUT_PATH}/Emgu.TF.World.dll" )

LIST(APPEND CS_FLAGS ${EMGU_TF_REFERENCE} )
  
GENERATE_DOCUMENT(${LIBRARY_OUTPUT_PATH}/${PROJECT_NAME})
SIGN_ASSEMBLY(${CMAKE_CURRENT_SOURCE_DIR}/../Emgu.TF.snk)
SET_CS_TARGET_FRAMEWORK(${CSC_TARGET_FRAMEWORK})
COMPILE_CS(${PROJECT_NAME} "library" "${SRC_EMGU_TF_MODEL}" ALL)

INSTALL(
FILES 
${LIBRARY_OUTPUT_PATH}/${PROJECT_NAME}.xml
${LIBRARY_OUTPUT_PATH}/${PROJECT_NAME}.dll 
DESTINATION ${CPACK_PACKAGE_CLI_FOLDER}
COMPONENT emgutf_binary)

ADD_DEPENDENCIES(${PROJECT_NAME} Emgu.TF.World)